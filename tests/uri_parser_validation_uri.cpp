#include <gtest/gtest.h>

#include <string>
#include <utility>

#include "token_reader.h"
#include "uri_parser.h"

using ValidationData = std::pair<std::string, bool>;

class UriParserUriTestingFixture: public ::testing::TestWithParam<ValidationData> {};

INSTANTIATE_TEST_SUITE_P(
        UriParserUriTests,
        UriParserUriTestingFixture,
        ::testing::Values(
            std::make_pair("", false),
            std::make_pair(":", false),
            std::make_pair(":website.com?q=5", false),
            std::make_pair("localhost", false),

            std::make_pair("https://example.com/", true),
            std::make_pair("https://example.com/ants/activity.htm", true),
            std::make_pair("https://berry.example.edu/bird#aunt", true),
            std::make_pair("https://berry.example.com/bath/bridge?advice=bone", true),
            std::make_pair("http://example.net/", true),
            std::make_pair("http://www.example.com/afterthought.php", true),
            std::make_pair("http://www.example.com/", true),
            std::make_pair("http://example.com/", true),
            std::make_pair("http://example.com/", true),
            std::make_pair("http://example.org/boot.html", true),
            std::make_pair("https://example.edu/approval", true),
            std::make_pair("https://angle.example.com/arm.html", true),
            std::make_pair("https://example.com/amount?book=breath&airplane=brick", true),
            std::make_pair("https://belief.example.com/bird.php", true),
            std::make_pair("https://www.example.net/birds.aspx", true),
            std::make_pair("http://www.example.com/#babies", true),
            std::make_pair("http://example.org/bear/bead?art=bath&authority=bag", true),
            std::make_pair("http://www.example.com/#aunt", true),
            std::make_pair("https://example.net/#beds", true),
            std::make_pair("https://www.example.com/argument.php", true),
            std::make_pair("https://www.example.net/?angle=breath&achiever=bite", true),
            std::make_pair("https://attack.example.com/#afterthought", true),
            std::make_pair("http://www.example.com/", true),
            std::make_pair("http://www.example.com/books.html?berry=army&bedroom=bag", true),
            std::make_pair("https://example.com/", true),
            std::make_pair("https://example.com/", true),
            std::make_pair("http://example.com/bike", true),
            std::make_pair("https://example.com/acoustics/baseball", true),
            std::make_pair("http://www.example.com/bird/account", true),
            std::make_pair("https://example.com/balance.php?attack=ants#bit", true),
            std::make_pair("https://example.com/", true),
            std::make_pair("http://www.example.com/", true),
            std::make_pair("http://www.example.net/", true),
            std::make_pair("https://www.example.com/?argument=account", true),
            std::make_pair("https://example.com/advice/bite", true),
            std::make_pair("https://example.com/blood", true),
            std::make_pair("http://arithmetic.example.com/bead#afterthought", true),
            std::make_pair("http://www.example.com/?bee=anger&advice=arithmetic", true),
            std::make_pair("http://www.example.com/beds", true),
            std::make_pair("https://www.example.net/action.html", true),
            std::make_pair("http://www.example.com/", true),
            std::make_pair("http://example.com/", true),
            std::make_pair("http://example.org/", true),
            std::make_pair("https://www.example.net/?birthday=beef", true),
            std::make_pair("http://example.com/boy.php", true),
            std::make_pair("http://www.example.com/beef.html", true),
            std::make_pair("http://alarm.example.com/bubble/basin", true),
            std::make_pair("http://example.com/afterthought/book.php?anger=appliance&bikes=baby", true),
            std::make_pair("https://example.com/", true),
            std::make_pair("https://www.example.com/boot", true),
            std::make_pair("http://www.example.org/bottle.aspx", true),
            std::make_pair("https://example.com/", true),
            std::make_pair("https://www.example.org/bottle.html?baby=believe", true),
            std::make_pair("http://approval.example.com/", true),
            std::make_pair("http://www.example.edu/advertisement/baseball", true),
            std::make_pair("https://example.com/babies.php", true),
            std::make_pair("http://www.example.com/bird.php", true),
            std::make_pair("http://www.example.com/", true),
            std::make_pair("https://www.example.com/?box=basketball&beef=birth", true),
            std::make_pair("http://appliance.example.org/", true),
            std::make_pair("https://www.example.com/back", true),
            std::make_pair("http://www.example.com/", true),
            std::make_pair("https://www.example.edu/anger/advice.htm", true),
            std::make_pair("https://example.com/branch/boundary.php", true),
            std::make_pair("https://bells.example.com/basin/boot.php", true),
            std::make_pair("http://www.example.com/blow", true),
            std::make_pair("http://example.com/act", true),
            std::make_pair("http://example.com/", true),
            std::make_pair("https://www.example.net/bead/action.html", true),
            std::make_pair("https://example.com/aftermath/army", true),
            std::make_pair("http://www.example.net/", true),
            std::make_pair("http://www.example.com/boot", true),
            std::make_pair("https://animal.example.org/", true),
            std::make_pair("https://example.org/", true),
            std::make_pair("http://example.com/animal.html", true),
            std::make_pair("https://www.example.com/bird.html", true),
            std::make_pair("http://www.example.com/bit/brake.php", true),
            std::make_pair("http://www.example.com/", true),
            std::make_pair("https://www.example.com/blade/achiever?bat=bird", true),
            std::make_pair("https://example.com/authority/beds.html", true),
            std::make_pair("https://example.com/", true),
            std::make_pair("http://www.example.com/?argument=bead#brick", true),
            std::make_pair("https://example.com/basketball", true),
            std::make_pair("http://approval.example.com/achiever#aftermath", true),
            std::make_pair("https://www.example.com/", true),
            std::make_pair("https://www.example.com/", true),
            std::make_pair("https://bomb.example.com/", true),
            std::make_pair("http://example.com/", true),
            std::make_pair("https://www.example.com/baseball", true),
            std::make_pair("https://example.net/", true),
            std::make_pair("https://bubble.example.com/", true),
            std::make_pair("http://www.example.com/bird", true),
            std::make_pair("https://boy.example.org/acoustics.php?baby=bee&bikes=bee", true),
            std::make_pair("http://appliance.example.com/bottle/bike", true),
            std::make_pair("https://www.example.net/?bells=authority", true),
            std::make_pair("http://example.net/", true),
            std::make_pair("http://battle.example.com/", true),
            std::make_pair("https://www.example.org/bee?believe=board", true),
            std::make_pair("https://breath.example.org/attraction/army.aspx", true),
            std::make_pair("https://www.example.edu/badge/addition#bait", true),
            std::make_pair("https://www.example.net/?arithmetic=advertisement", true),
            std::make_pair("https://example.com/apparel.html?behavior=boy", true),
            std::make_pair("http://www.example.com/#advertisement", true),
            std::make_pair("https://www.example.com/", true),
            std::make_pair("https://bee.example.com/", true),
            std::make_pair("https://www.example.net/boat", true),
            std::make_pair("http://www.example.com/", true),
            std::make_pair("https://example.com/birds", true),
            std::make_pair("http://www.example.com/", true),
            std::make_pair("http://example.com/?boat=boat#basin", true),
            std::make_pair("http://example.com/", true),
            std::make_pair("https://example.com/aftermath.html", true),
            std::make_pair("http://bell.example.com/book/army.php", true),
            std::make_pair("http://example.com/", true),
            std::make_pair("https://www.example.com/boundary/argument.php?adjustment=boot", true),
            std::make_pair("http://www.example.com/", true),
            std::make_pair("http://www.example.com/activity/addition.htm?breath=argument", true),
            std::make_pair("http://example.com/bedroom?base=army&blade=beef", true),
            std::make_pair("http://www.example.org/bone.php", true),
            std::make_pair("https://example.org/blow/boundary.aspx#bath", true),
            std::make_pair("http://alarm.example.net/bee/beginner.html", true),
            std::make_pair("http://bit.example.com/bridge/apparatus.htm", true),
            std::make_pair("http://arm.example.com/", true),
            std::make_pair("http://www.example.com/bait.aspx#basketball", true),
            std::make_pair("http://example.org/actor.aspx?angle=authority", true),
            std::make_pair("http://www.example.com/basin.aspx", true),
            std::make_pair("https://apparatus.example.com/boat/beef?blood=border", true),
            std::make_pair("http://www.example.com/approval.aspx", true),
            std::make_pair("http://afternoon.example.com/bed/appliance.php", true),
            std::make_pair("https://www.example.com/border/alarm.php", true),
            std::make_pair("http://example.com/?boundary=authority&bit=achiever", true),
            std::make_pair("https://belief.example.com/", true),
            std::make_pair("https://example.com/afternoon/blade.php", true),
            std::make_pair("https://www.example.com/boy/bath", true),
            std::make_pair("http://art.example.com/?air=adjustment", true),
            std::make_pair("http://example.com/believe#attack", true),
            std::make_pair("http://www.example.com/", true),
            std::make_pair("http://www.example.com/blade/airport.php", true),
            std::make_pair("http://www.example.com/", true),
            std::make_pair("https://example.com/acoustics/birth?bubble=arithmetic#boundary", true),
            std::make_pair("http://example.net/brick", true),
            std::make_pair("http://www.example.com/#animal", true),
            std::make_pair("https://example.com/bedroom?bubble=anger&achiever=addition", true),
            std::make_pair("http://www.example.com/", true),
            std::make_pair("https://www.example.com/arithmetic/behavior.html", true),
            std::make_pair("https://www.example.com/air", true),
            std::make_pair("http://example.net/", true),
            std::make_pair("http://www.example.com/baseball?bait=anger&blow=account", true),
            std::make_pair("https://bedroom.example.com/attack?activity=bite", true),
            std::make_pair("http://example.net/board/bath", true),
            std::make_pair("https://www.example.org/birthday", true),
            std::make_pair("https://example.org/", true),
            std::make_pair("https://www.example.org/bike.php", true),
            std::make_pair("http://example.com/#actor", true),
            std::make_pair("https://www.example.com/", true),
            std::make_pair("https://www.example.org/", true),
            std::make_pair("http://www.example.com/airplane.php", true),
            std::make_pair("https://www.example.net/art", true),
            std::make_pair("http://example.org/amount?beef=believe", true),
            std::make_pair("https://baseball.example.com/branch", true),
            std::make_pair("http://example.com/", true),
            std::make_pair("http://example.com/alarm?bikes=addition&back=boy", true),
            std::make_pair("https://example.com/badge/back", true),
            std::make_pair("https://www.example.org/", true),
            std::make_pair("http://example.com/book/bat", true),
            std::make_pair("http://www.example.org/apparel?art=box", true),
            std::make_pair("http://www.example.com/?army=blood&blood=activity", true),
            std::make_pair("https://example.com/breath#attraction", true),
            std::make_pair("https://example.org/boy/basket.php", true),
            std::make_pair("http://angle.example.com/", true),
            std::make_pair("https://example.com/boot/afternoon", true),
            std::make_pair("https://example.com/?box=acoustics", true),
            std::make_pair("http://www.example.org/airport.php?beds=art#amusement", true),
            std::make_pair("http://www.example.org/advice.htm", true),
            std::make_pair("http://example.com/", true),
            std::make_pair("http://www.example.com/", true),
            std::make_pair("https://art.example.org/?blow=arch#advertisement", true),
            std::make_pair("http://www.example.org/beef?bead=bubble&back=argument#back", true),
            std::make_pair("http://www.example.net/", true),
            std::make_pair("https://www.example.com/authority.php", true),
            std::make_pair("http://example.com/?angle=apparatus&badge=border", true),
            std::make_pair("https://www.example.com/?board=base&art=account", true),
            std::make_pair("https://www.example.com/approval", true),
            std::make_pair("https://airplane.example.com/", true),
            std::make_pair("http://www.example.com/balance/alarm", true),
            std::make_pair("https://example.com/#breath", true),
            std::make_pair("http://example.com/bell", true),
            std::make_pair("http://example.com/berry", true),
            std::make_pair("https://example.com/acoustics/ball.html", true),
            std::make_pair("https://example.org/advice/bell.php", true),
            std::make_pair("http://branch.example.org/", true),
            std::make_pair("https://example.com/baseball", true),
            std::make_pair("https://example.com/?badge=bottle", true),
            std::make_pair("https://example.com/", true),
            std::make_pair("http://www.example.com/", true),
            std::make_pair("http://www.example.org/", true),
            std::make_pair("https://www.example.net/advertisement.aspx", true),
            std::make_pair("http://www.example.com/?bells=brother#battle", true),
            std::make_pair("https://www.example.com/bomb/alarm.html", true),
            std::make_pair("https://approval.example.com/balance.php?bite=bike&attack=basket", true)
        )
);

TEST_P(UriParserUriTestingFixture, TestThatUriParsingIsCorrect) {
    const auto& pair = GetParam();

    const auto& text = pair.first;
    const auto& expected_result = pair.second;

    uri::__internal::TokenReader reader(text);
    EXPECT_EQ(uri::__internal::uri(reader), expected_result);
}
